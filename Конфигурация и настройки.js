/*
 * 📋 1 КОНФИГУРАЦИЯ И НАСТРОЙКИ
 * 
 * ✅ Что делает: Все настройки, константы и страны в одном месте
 * 🔧 Меняете здесь: месяцы, ID таблиц, список стран, исключенных сеошников
 * 
 * Автор: Claude AI
 * Дата: 2025
 */

// ========================================================================
// 📅 НАСТРОЙКИ МЕСЯЦЕВ
// ========================================================================

const МЕСЯЦЫ = {
  БАЗОВЫЙ: 'Июнь 2025',      // Предыдущий месяц для сравнения
  ТЕКУЩИЙ: 'Июль 2025',       // Текущий месяц для анализа
  
  // Список всех доступных месяцев
  ДОСТУПНЫЕ: [
    'Май 2025', 'Июнь 2025', 'Июль 2025', 'Август 2025',
    'Сентябрь 2025', 'Октябрь 2025', 'Ноябрь 2025', 'Декабрь 2025'
  ],
  
  // Карта предыдущих месяцев
  ПРЕДЫДУЩИЙ: {
    'Июнь 2025': 'Май 2025',
    'Июль 2025': 'Июнь 2025', 
    'Август 2025': 'Июль 2025',
    'Сентябрь 2025': 'Август 2025',
    'Октябрь 2025': 'Сентябрь 2025',
    'Ноябрь 2025': 'Октябрь 2025',
    'Декабрь 2025': 'Ноябрь 2025'
  }
};

// ========================================================================
// 🗂️ ID GOOGLE SHEETS ТАБЛИЦ
// ========================================================================

const ТАБЛИЦЫ = {
  ОСНОВНАЯ: '1hX3ElN4Y2Oxs-8SWfZX4YQ7x0m7vcdl7y-ASxVNYCzg',  // Main table с данными
  САЙТЫ: '1zgVijhVddHS-5qdz8osan5WWsixObxslssaDTZyiQLA',     // Sites table со справочником
  РЕЗУЛЬТАТ: '17QqRPhO5nbHwUt4ReZpV7DSRP0XPFcP4__1rOCTmZ7M'   // Таблица для сводных
};

// ========================================================================
// 🌍 СТРАНЫ С ФЛАГАМИ
// ========================================================================

const СТРАНЫ = {
  'AZ': { флаг: '🇦🇿', название: 'Азербайджан', полное: '🇦🇿 AZ (Азербайджан)' },
  'RU': { флаг: '🇷🇺', название: 'Россия', полное: '🇷🇺 RU (Россия)' },
  'HU': { флаг: '🇭🇺', название: 'Венгрия', полное: '🇭🇺 HU (Венгрия)' },
  'UZ': { флаг: '🇺🇿', название: 'Узбекистан', полное: '🇺🇿 UZ (Узбекистан)' },
  'KZ': { флаг: '🇰🇿', название: 'Казахстан', полное: '🇰🇿 KZ (Казахстан)' },
  'BY': { флаг: '🇧🇾', название: 'Беларусь', полное: '🇧🇾 BY (Беларусь)' },
  'UA': { флаг: '🇺🇦', название: 'Украина', полное: '🇺🇦 UA (Украина)' },
  'GE': { флаг: '🇬🇪', название: 'Грузия', полное: '🇬🇪 GE (Грузия)' },
  'AM': { флаг: '🇦🇲', название: 'Армения', полное: '🇦🇲 AM (Армения)' },
  'MD': { флаг: '🇲🇩', название: 'Молдова', полное: '🇲🇩 MD (Молдова)' },
  'TJ': { флаг: '🇹🇯', название: 'Таджикистан', полное: '🇹🇯 TJ (Таджикистан)' },
  'KG': { флаг: '🇰🇬', название: 'Киргизия', полное: '🇰🇬 KG (Киргизия)' },
  'TM': { флаг: '🇹🇲', название: 'Туркменистан', полное: '🇹🇲 TM (Туркменистан)' },
  'LT': { флаг: '🇱🇹', название: 'Литва', полное: '🇱🇹 LT (Литва)' },
  'LV': { флаг: '🇱🇻', название: 'Латвия', полное: '🇱🇻 LV (Латвия)' },
  'EE': { флаг: '🇪🇪', название: 'Эстония', полное: '🇪🇪 EE (Эстония)' },
  'PL': { флаг: '🇵🇱', название: 'Польша', полное: '🇵🇱 PL (Польша)' },
  'CZ': { флаг: '🇨🇿', название: 'Чехия', полное: '🇨🇿 CZ (Чехия)' },
  'SK': { флаг: '🇸🇰', название: 'Словакия', полное: '🇸🇰 SK (Словакия)' },
  'RS': { флаг: '🇷🇸', название: 'Сербия', полное: '🇷🇸 RS (Сербия)' },
  'BG': { флаг: '🇧🇬', название: 'Болгария', полное: '🇧🇬 BG (Болгария)' },
  'RO': { флаг: '🇷🇴', название: 'Румыния', полное: '🇷🇴 RO (Румыния)' },
  'TR': { флаг: '🇹🇷', название: 'Турция', полное: '🇹🇷 TR (Турция)' },
  'GR': { флаг: '🇬🇷', название: 'Греция', полное: '🇬🇷 GR (Греция)' },
  'AL': { флаг: '🇦🇱', название: 'Албания', полное: '🇦🇱 AL (Албания)' },
  'MK': { флаг: '🇲🇰', название: 'Македония', полное: '🇲🇰 MK (Македония)' },
  'BA': { флаг: '🇧🇦', название: 'Босния и Герцеговина', полное: '🇧🇦 BA (Босния и Герцеговина)' },
  'HR': { флаг: '🇭🇷', название: 'Хорватия', полное: '🇭🇷 HR (Хорватия)' },
  'SI': { флаг: '🇸🇮', название: 'Словения', полное: '🇸🇮 SI (Словения)' },
  'ME': { флаг: '🇲🇪', название: 'Черногория', полное: '🇲🇪 ME (Черногория)' }
};

// ========================================================================
// 🚫 ИСКЛЮЧЕННЫЕ СЕОШНИКИ
// ========================================================================

const ИСКЛЮЧЕННЫЕ_СЕОШНИКИ = [
  'Редирект с цмс',
  'Погрешность трекера', 
  'Dragon',
  'Неизвестно',
  'Нет трафика'
];

// ========================================================================
// 🎨 ЦВЕТОВАЯ СХЕМА
// ========================================================================

const ЦВЕТА = {
  ВСЕГО: '#C3DECE',           // Мягкий зеленый для "Всего"
  БРЕНДЫ: '#C3BBD9',          // Элегантный фиолетовый для брендов
  БРЕНД_ГЕО: '#FAEBD7',       // Теплый персиковый для бренд+гео
  ГЕО: '#CEC4DD',             // Нежный сиреневый для стран
  ГЕО_БРЕНД: '#FCECD3',       // Солнечный желтый для гео+бренд
  ПОТОКИ: '#B2D4CF',          // Свежий зеленый для потоков
  СЕОШНИКИ: '#D9DAD6',        // Нейтральный серый для сеошников
  ИСКЛЮЧЕННЫЕ: '#E8E8E8',     // Светло-серый для исключенных
  САЙТЫ: '#F3E3EB',           // Деликатный розовый для сайтов
  
  // Цвета роста
  РОСТ: '#00B050',            // Зеленый для роста
  ПАДЕНИЕ: '#FF0000',         // Красный для падения  
  НОВЫЕ_ДАННЫЕ: '#FFA500',    // Оранжевый для новых данных
  БЕЗ_ИЗМЕНЕНИЙ: '#808080'    // Серый для нуля
};

// ========================================================================
// 📊 СТРУКТУРА СТОЛБЦОВ РОСТА
// ========================================================================

const СТОЛБЦЫ_РОСТА = [
  { название: 'Клики', столбец_роста: 6, столбец_процента: 7, столбец_данных: 4 },        // F-G (данные из D)
  { название: 'Реги', столбец_роста: 10, столбец_процента: 11, столбец_данных: 8 },       // J-K (данные из H)
  { название: 'FD', столбец_роста: 14, столбец_процента: 15, столбец_данных: 12 },        // N-O (данные из L)
  { название: 'RD', столбец_роста: 18, столбец_процента: 19, столбец_данных: 16 },        // R-S (данные из P) ✅ ИСПРАВЛЕНО
  { название: 'Расход', столбец_роста: 23, столбец_процента: 24, столбец_данных: 22 },    // W-X (данные из V) ✅ ДОБАВЛЕНО
  { название: 'Выручка', столбец_роста: 27, столбец_процента: 28, столбец_данных: 25 },   // AA-AB (данные из Y) ✅ ИСПРАВЛЕНО
  { название: 'Прибыль', столбец_роста: 30, столбец_процента: 31, столбец_данных: 29 }    // AD-AE (данные из AC) ✅ ИСПРАВЛЕНО
];

// ========================================================================
// 🔧 ВСПОМОГАТЕЛЬНЫЕ ФУНКЦИИ
// ========================================================================

/**
 * Получить код страны в едином виде - поддерживает одиночные и составные коды
 */
function получитьСтрану(код) {
  return код; // ВОЗВРАЩАЕТ КОД КАК ЕСТЬ: "HU", "UZ / AZ", "КR / JP" БЕЗ ФЛАГОВ/ЭМОДЗИ/НАЗВАНИЙ
}

/**
 * Получить предыдущий месяц
 */
function получитьПредыдущийМесяц(месяц) {
  return МЕСЯЦЫ.ПРЕДЫДУЩИЙ[месяц] || null;
}

/**
 * Проверить доступность месяца
 */
function доступенМесяц(месяц) {
  return МЕСЯЦЫ.ДОСТУПНЫЕ.includes(месяц);
}

/**
 * Изменить период анализа
 */
function изменитьПериод(базовыйМесяц, текущийМесяц) {
  if (!доступенМесяц(базовыйМесяц) || !доступенМесяц(текущийМесяц)) {
    throw new Error('Один из месяцев недоступен');
  }
  
  МЕСЯЦЫ.БАЗОВЫЙ = базовыйМесяц;
  МЕСЯЦЫ.ТЕКУЩИЙ = текущийМесяц;
  
  console.log(`📅 Период изменен: ${базовыйМесяц} → ${текущийМесяц}`);
}

/**
 * Получить текущую конфигурацию
 */
function получитьКонфигурацию() {
  return {
    базовыйМесяц: МЕСЯЦЫ.БАЗОВЫЙ,
    текущийМесяц: МЕСЯЦЫ.ТЕКУЩИЙ,
    таблицы: ТАБЛИЦЫ,
    страны: Object.keys(СТРАНЫ).map(код => СТРАНЫ[код].полное),
    исключенныеСеошники: ИСКЛЮЧЕННЫЕ_СЕОШНИКИ
  };
}

console.log('📋 КОНФИГУРАЦИЯ ЗАГРУЖЕНА');
console.log(`📅 Текущий период: ${МЕСЯЦЫ.БАЗОВЫЙ} → ${МЕСЯЦЫ.ТЕКУЩИЙ}`);
console.log(`🌍 Стран в справочнике: ${Object.keys(СТРАНЫ).length}`);
